---
title: "Analysis of Traffic Offences Across Toronto Neighborhoods"
subtitle: "The effect of neighbourhoods incomes"
author: 
  - Gadiel David Flores
thanks: "Code and data are available at: https://open.toronto.ca/dataset/police-annual-statistical-report-tickets-issued/"
date: today
date-format: long
abstract: "In this paper, we will be looking at police annual reports of tickets isssued and analayzing the frequency in tickets issued based on different neighbourhoods. We will focus on which neighbourhoods exhibit the highest number of specific traffic offences (e.g., Aggressive Driving, Speeding). and are there observable geographical patterns or clusters of these offences based on neighbourhood? Additionally, how do the averages relate to the overall frequency of offences across different neighbourhoods?"
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
```


# Introduction

Higher police presence could lead to higher traffic violations.
It is probable that lower income neighborhoods have a higher police presence and would lead to higher citations overall. Another pattern that may be noticed is more dangerous roads that are prone for human error that leads to more violations given and this could be a potential exploit by officers as they may know this information beforehand. We use @citeR and @TorontoPoliceData2024.

The remainder of this paper is structured as follows. @sec-data will explore our data from @TorontoPoliceData2024 and show any potential clusters and patterns that may be in the number of offences given, locations, and type of citation and we will use this to further analyze in @sec-model. Lastly, we will discuss our findings in @sec-result.

# Data {#sec-data}
In this section we will be specifically looking at the names of neighbourhoods, and how many citations they got from years [TODO: find the minimum year and the max year]. The data of the frequency of each citation can be seen (@fig-citations), and was extract from @TorontoPoliceData2024.

```{r}
#| label: fig-citations
#| fig-cap: Frequency of Citations by Neighbourhood
#| echo: false

# Load necessary libraries
library(ggplot2)
library(here)

# Load the data from the CSV file using 'here'
tickets_data <- read.csv(here::here("data/sim_data/tickets_issued_data.csv"))

# bar plot focusing on neighbourhoods
ggplot(tickets_data, aes(x = neighbourhood)) +
  geom_bar() +
  labs(title = "Frequency of Citations by Neighbourhood", x = "Neighbourhood", y = "Count of Citations") +
  theme_minimal()

```
As it can be seen in this graph, [TODO: Talk about any patterns or observations from the real dataset]. In (@fig-income) we can see which neighborhoods have a higher income and which ones are lower income.This data came from the latest census of toronto and the only variables taken out from this data was the neighbourhoods and their average income. This data comes from [TODO: add reference to toronto data].

```{r}
#| label: fig-income
#| fig-cap: Toronto Neighbourhoods income
#| echo: false
#| warning: false
#| message: false

# Load necessary libraries
library(ggplot2)
library(here)

# Load the data from the CSV file using 'here'
income_data <- read.csv(here::here("data/sim_data/average_income.csv"))

# bar plot for average income by neighbourhood
ggplot(income_data, aes(x = neighbourhood, y = average_income)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Income by Neighbourhood", x = "Neighbourhood", y = "Average Income (in thousands)") +
  theme_minimal()


```

This data shows actual numbers of citations given out in each neighbourhood and the average income of each neighbourhood of each household comebined. Based on these graphs, we can see [TODO: Talk about any patterns or observations from the real dataset]. This raises a question on whether there is a correlation on income and the amount of citations that are given out. In the next seciton we will come with a model that can help us find a correlation. 


# Model {#sec-model}


The goal of our modelling strategy is twofold. Firstly, is there a relationship between the income and how much offences they get. Secondly, how strong is this relationship. 
We will be using Simple Linear Regression model to see the effect of income and the number of citations given in that neighborhood. Background details and diagnostics are included in [Appendix -@sec-model-details].
## Model set-up

Define $y_i$ as the number offences done by a certain neighborhood. Then $x_i$ is the average income of a certain neighborhood measured in thousands.  

\begin{align} 
E(Y|X)Y_i = \beta_0 + \beta_1(X)
\end{align}


### Model justification

The reason a linear regression model was specifically chosen was because we want to analyze the effect of an increase of citation, does it mean that the income of the neighborhood goes down or does it go up? This will allow us to see how strong of a relationship there is between citations and average neighbourhood income. 




# Results {#sec-results}

We expect a positive relationship between the number offences given and the lower the income of the neighborhood. In particular... 

Our results are summarized in @ressidual_plots. Residual vs. Predictors, Residuals vs. fitted values and Normal quantile-quantile are all used to verify that our 4 assumptions of linear regression models aren't violation and that the data is works as intended. We can see that Linearity is  [TODO: check if linarity is violated]. Uncorrelated errors is [TODO: check if uncorralted isnt violated], and constant error is [TODO: check if constant error isnt varied], lastly nromality of errors [TODO: check if normal]. Give all these assumptions, we can [TODO: check if we can trust results of linear regression]

# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}

## Linear Regression

In @fig-ppcheckandposteriorvsprior-1 we implement a p	
Simple Linear Regression Model. This shows...

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: ressidual_plots
#| layout-ncol: 2
#| fig-cap: "Examining how the model fits, and is affected by, the data"
#| fig-subcap: ["Creates a formula Y = B_O + B_1 X"]

#[TODO: show regression model]
```

## Diagnostics

@fig-ResidualDiagnostics-1 is a Residual vs. Fitted Values Plot. It shows... This suggests...

@fig-ResidualDiagnostics-2 is a Normal Q-Q Plot. It shows... This suggests...

@fig-ResidualDiagnostics-3 is a . Residuals vs. Predictors Plot. It shows... This suggests...

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-ResidualDiagnostics
#| fig-cap: "Diagnostic plots to assess residuals."
#| fig-subcap: ["Residuals vs. Fitted Values", "Normal Q-Q Plot", "Residuals vs. Predictors"]
#| layout-ncol: 2

#[TODO: Create plots]

```
\newpage


# References


